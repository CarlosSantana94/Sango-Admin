<ion-header>
    <ion-toolbar color="primary">
        <ion-title>Pedidos</ion-title>
    </ion-toolbar>
</ion-header>

<ion-content>
    <!-- Filtros de estado -->
    <ion-segment [(ngModel)]="estadoSeleccionado" (ionChange)="filtrarCarritos()">
        <ion-segment-button *ngFor="let estado of estados" [value]="estado">
            <ion-text>{{ estadosAlias[estado] }} ({{ carritosPorEstado[estado]?.total || 0 }})</ion-text>
        </ion-segment-button>
    </ion-segment>

    <!-- Filtros por fecha -->
    <ion-segment [(ngModel)]="filtroFechaSeleccionado" (ionChange)="filtrarPorFecha()">
        <ion-segment-button value="todos">
            <ion-text>Todos ({{ conteoPorFecha.todos || 0 }})</ion-text>
        </ion-segment-button>
        <ion-segment-button value="retrasados">
            <ion-text>Retrasados ({{ conteoPorFecha.retrasados || 0 }})</ion-text>
        </ion-segment-button>
        <ion-segment-button value="hoy">
            <ion-text>Hoy ({{ conteoPorFecha.hoy || 0 }})</ion-text>
        </ion-segment-button>
        <ion-segment-button value="futuros">
            <ion-text>Futuros ({{ conteoPorFecha.futuros || 0 }})</ion-text>
        </ion-segment-button>
    </ion-segment>

    <!-- Lista de carritos filtrados -->
    <ion-grid>
        <ion-row>
            <ion-col size="12" size-md="6" *ngFor="let carrito of carritosFiltrados">
                <ion-card>
                    <ion-card-header>
                        <ion-card-title>Orden #{{ carrito.carrito.id }}</ion-card-title>
                        <ion-card-subtitle>Total: ${{ carrito.totalCarrito }}</ion-card-subtitle>
                    </ion-card-header>
                    <ion-card-content>
                        <p><strong>Recolección:</strong> {{ carrito.carrito.envios.fechaRecoleccion | date:'dd/MM/yyyy' }}</p>
                        <p><strong>Entrega:</strong> {{ carrito.carrito.envios.fechaEntrega | date:'dd/MM/yyyy' }}</p>
                        <p><strong>Cliente:</strong> {{ carrito.carrito.direccion.nombre }}</p>
                        <p><strong>Dirección:</strong> {{ carrito.carrito.direccion.direccion }}</p>
                        <p><strong>Teléfono:</strong> {{ carrito.carrito.direccion.tel }}</p>
                        <ion-button color="primary" (click)="verDetalle(carrito.carrito.id)">Ver Detalle</ion-button>
                    </ion-card-content>
                </ion-card>
            </ion-col>
        </ion-row>
    </ion-grid>
</ion-content>
